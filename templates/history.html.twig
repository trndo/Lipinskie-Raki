{% extends 'base.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('footer') }}
{% endblock %}
{% block body %}
    <div class="container">
        {% set sum = app.session.get('totalSum') %}
        {% include 'elements/small_header.html.twig' %}
        <main>
            {% include 'elements/additionalNavUser.html.twig' with { 'active': 'user-orders'} %}
            <div class="user-tabs">
                <div class="user-tab" data-path="{{ path('user',{'uniqueId': app.user.uniqueId}) }}">Личные данные</div>
                <div class="user-tab user-tab-active" data-path="{{ path('user_orders',{'uniqueId': app.user.uniqueId}) }}">История заказов</div>
                <div class="user-tab user-tab-last" data-path="{{ path('resetPass',{'uniqueId': app.user.uniqueId}) }}">Поменять пароль</div>
            </div>
            <div class="user-red-content">
                <embed id="steamed-fish" type="image/svg+xml" src="/assets/img/steamed-fish.svg"/>
                <div class="user-title">
                    <span class="attention-subtitle">Не помнишь что заказал и когда ?</span><br>
                    <span class="attention-title">Или хочешь повторить заказ</span>
                </div>
                <div class="history-container">
                    {% for order in orders %}
                        <div class="history-item {{ order.status != 'done' ? 'item-in-process' : '' }}">
                            <img src="{{ order.orderDetails.0.product.TitlePhotoPath }}" class="history-item-img"
                                 alt="photo">
                            <div class="history-item-info">
                                <div class="order-id-date-status">
                                    <span class="order-id">№{{ order.id }}</span>
                                    <!-- order-cook order-delivery order-proc -->
                                    {% if order.status == 'new' %}
                                        <span class="date-status">В осмотре <span class="order-stat order-proc"></span></span>
                                    {% elseif order.status == 'payed' %}
                                        <span class="date-status">Готовится <span class="order-stat order-cook"></span></span>
                                    {% elseif order.status == 'done' %}
                                        <span class="date-status">В пути к вам<span
                                                    class="order-stat order-delivery"></span></span>
                                    {% elseif order.status == 'failure' %}
                                        <span class="date-status">Неудачная оплата, повторите<span
                                                    class="order-stat order-delivery"></span></span>
                                    {% elseif order.status == 'canceled' %}
                                        <span class="date-status">Отменено<span
                                                    class="order-stat"></span></span>
                                    {% else %}
                                        <span class="date-status">{{ order.orderDate|date('d/m/y') }}</span>
                                    {% endif %}
                                </div>
                                <div class="order-total">
                                    {{ order.totalPrice }} <span class="hryvna">₴</span>
                                </div>
                                <div class="history-actions">
                                    <div class="history-btn history-more" data-show="show">
                                        Подробнее
                                    </div>
                                    {% set user = app.user %}
                                    {% if order.status == 'confirmed' %}
                                    <div class="history-btn"
                                         onclick="window.location.href='{{ path('pay', { 'orderUniqueId': order.orderUniqueId, 'user_unique_id' : user.uniqueId }) }}'">Оплатить
                                    </div>
                                    {% endif %}
                                    {% if order.status == 'confirmed' %}
                                        <div class="history-btn"
                                            onclick="window.location.href='{{ path('cancelUserOrder',{ 'user_unique_id': user.uniqueId, 'orderUniqueId': order.orderUniqueId }) }}'">Отменить</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="attention-promotion">
                <div class="bonuses-in-attention">
                    100/<span class="bonus-bold">2000</span>
                </div>
                <div class="promotion-title">
                    <span class="attention-subtitle">Купи товаров на 2000 грн за всё время</span>
                    <span class="attention-title">Получи Рыбу в подарок</span>
                </div>
                <div class="scale">
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                    <div class="scale-section"></div>
                </div>
            </div>
        </main>
    </div>
    {% include 'elements/__footer.html.twig' with { 'active': false } %}
    {% include 'elements/mobile-nav.html.twig' with {'mob_active': false} %}
    <div id="overlay">
        <div class="order-more">
            <img src="{{ asset('assets/img/test.jpg') }}" class="order-more-img">
            <div class="order-more-info">
                <div class="order-id-date-status">
                    <span class="order-id">№0166610</span>
                    <span class="date-status">26/06/2019</span>
                </div>
                <div class="order-total">
                    5500 <span class="hryvna">₴</span>
                </div>
                <ul class="order-more-list">
                    <li>Заказ</li>
                </ul>
                <div class="history-actions">
                    <div id="close-more" class="history-btn history-more">
                        Закрыть
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}